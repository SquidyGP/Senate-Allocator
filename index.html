<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Senate Seat Allocator</title>
<style>
    body { font-family: Arial, sans-serif; margin: 2rem; background: #f0f2f5; }
    h1, h2 { color: #333; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    input { width: 100%; padding: 0.4rem; box-sizing: border-box; }
    button { padding: 0.5rem 1rem; font-size: 1rem; margin-bottom: 1rem; }
    pre { background: #fff; padding: 1rem; border-radius: 5px; overflow-x: auto; }
    .add-row { margin-bottom: 1rem; }
</style>
</head>
<body>

<h1>Senate Seat Allocator</h1>

<h2>House Results</h2>
<table id="houseTable">
    <thead>
        <tr><th>Party Name</th><th>Votes</th><th>Action</th></tr>
    </thead>
    <tbody>
        <tr>
            <td><input value="Reclaim"></td>
            <td><input type="number" value="6"></td>
            <td><button onclick="deleteRow(this)">Delete</button></td>
        </tr>
        <tr>
            <td><input value="Purple Crown"></td>
            <td><input type="number" value="5"></td>
            <td><button onclick="deleteRow(this)">Delete</button></td>
        </tr>
    </tbody>
</table>
<button class="add-row" onclick="addHouseRow()">+ Add Party</button>

<h2>Party Lists (Candidates)</h2>
<table id="partyListTable">
    <thead>
        <tr><th>Party Name</th><th>Candidate Names (comma-separated)</th><th>Action</th></tr>
    </thead>
    <tbody>
        <tr>
            <td><input value="Reclaim"></td>
            <td><input value="Josef, John Louis"></td>
            <td><button onclick="deleteRow(this)">Delete</button></td>
        </tr>
        <tr>
            <td><input value="Purple Crown"></td>
            <td><input value="Cierna"></td>
            <td><button onclick="deleteRow(this)">Delete</button></td>
        </tr>
    </tbody>
</table>
<button class="add-row" onclick="addPartyListRow()">+ Add Party</button>

<h2>Settings</h2>
<label>Required Vacant Seats:</label>
<input type="number" id="requiredVacant" value="5" min="0">

<br><br>
<button onclick="allocateSeats()">Allocate Seats</button>

<h2>Results</h2>
<pre id="results"></pre>

<script>
function deleteRow(button) {
    const row = button.parentElement.parentElement;
    row.parentElement.removeChild(row);
}

function addHouseRow() {
    const tbody = document.getElementById("houseTable").querySelector("tbody");
    const row = document.createElement("tr");
    row.innerHTML = `<td><input></td><td><input type="number"></td><td><button onclick="deleteRow(this)">Delete</button></td>`;
    tbody.appendChild(row);
}

function addPartyListRow() {
    const tbody = document.getElementById("partyListTable").querySelector("tbody");
    const row = document.createElement("tr");
    row.innerHTML = `<td><input></td><td><input></td><td><button onclick="deleteRow(this)">Delete</button></td>`;
    tbody.appendChild(row);
}

function allocateSeats() {
    const houseResults = {};
    document.querySelectorAll("#houseTable tbody tr").forEach(row => {
        const cells = row.querySelectorAll("input");
        if(cells[0].value) houseResults[cells[0].value] = parseInt(cells[1].value) || 0;
    });

    const partyLists = {};
    document.querySelectorAll("#partyListTable tbody tr").forEach(row => {
        const cells = row.querySelectorAll("input");
        if(cells[0].value) partyLists[cells[0].value] = cells[1].value.split(",").map(s => s.trim()).filter(Boolean);
    });

    const requiredVacantSeats = parseInt(document.getElementById("requiredVacant").value);

    let senateSeats = {};
    let seatAssignments = [];
    let assignedSeats = 0, vacantSeats = 0, occupiedSeats = 0;
    let occupiedByParty = {}, vacantByParty = {};

    for (let party in houseResults) {
        senateSeats[party] = 0;
        occupiedByParty[party] = 0;
        vacantByParty[party] = 0;
    }

    function getNextCandidate(party) {
        return partyLists[party] && partyLists[party].length ? partyLists[party].shift() : null;
    }

    while (vacantSeats < requiredVacantSeats) {
        let quotients = {};
        for (let party in houseResults) {
            quotients[party] = houseResults[party] / (senateSeats[party] + 1);
        }
        let nextParty = Object.keys(quotients).reduce((a,b) => quotients[a] > quotients[b] ? a : b);
        let candidate = getNextCandidate(nextParty);

        assignedSeats += 1;
        senateSeats[nextParty] += 1;

        if (candidate) {
            seatAssignments.push([assignedSeats, nextParty, candidate]);
            occupiedSeats += 1;
            occupiedByParty[nextParty] += 1;
        } else {
            seatAssignments.push([assignedSeats, nextParty, "VACANT"]);
            vacantSeats += 1;
            vacantByParty[nextParty] += 1;
        }
    }

    let nextQuotients = {};
    for (let party in houseResults) {
        nextQuotients[party] = houseResults[party] / (senateSeats[party] + 1);
    }
    let nextInLineParty = Object.keys(nextQuotients).reduce((a,b) => nextQuotients[a] > nextQuotients[b] ? a : b);

    let output = `Senate Seat Assignments:\n`;
    seatAssignments.forEach(([num, party, member]) => {
        output += `Seat ${num}: ${party} â†’ ${member}\n`;
    });

    output += `\nSeat Totals (including vacant seats):\n`;
    for (let party in senateSeats) output += `${party}: ${senateSeats[party]}\n`;

    output += `\nOccupied Seats by Party:\n`;
    for (let party in occupiedByParty) output += `${party}: ${occupiedByParty[party]}\n`;

    output += `\nVacant Seats by Party:\n`;
    for (let party in vacantByParty) output += `${party}: ${vacantByParty[party]}\n`;

    output += `\nTotal Occupied Seats: ${occupiedSeats}\n`;
    output += `Total Vacant Seats: ${vacantSeats}\n`;
    output += `\nðŸ“Œ Next Party in Line for a Seat: ${nextInLineParty}`;

    document.getElementById("results").textContent = output;
}
</script>

</body>
</html>